{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My Django Site{% endblock %}</title>
    
    <!-- CSS files -->
    <link rel="stylesheet" href="{% static 'dist/output.css' %}">
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    
    {% block extra_head %}
    <!-- Additional head content -->
    {% endblock %}
</head>
<!-- Icons -->
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<body x-data="{ sidebarOpen: false }">
    <div class="flex h-screen bg-gray-100">
        <!-- Sidebar -->
        {% include 'includes/sidebar.html' %}

        <div class="flex-1 flex flex-col overflow-hidden lg:ml-72">
            <!-- Navbar -->
            {% if user.is_authenticated %}
                {% include 'includes/logged_in_header.html' %}
            {% else %}
                {% include 'includes/header_marketing.html' %}
            {% endif %}

            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100">
                <div class="container mx-auto min-h-screen">
                    {% block content %}
                    <!-- Main content goes here -->
                    {% endblock %}
                </div>
                {% include 'includes/footer.html' %}
            </main>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@4.0.1/dist/flowbite.min.js"></script>
    
    <!-- JavaScript files -->
    {% block scripts %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Function to handle smooth scrolling
            function smoothScrollTo(targetId) {
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop,
                        behavior: 'smooth'
                    });
                }
            }

            // Handle clicks on navigation links
            document.querySelectorAll('.nav-link').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    const hashIndex = href.lastIndexOf('#');
                    
                    if (hashIndex !== -1) {
                        const targetId = href.substring(hashIndex + 1);
                        
                        // Check if the link is on the same page
                        if (window.location.pathname === href.substring(0, hashIndex) || href.startsWith('#')) {
                            e.preventDefault();
                            smoothScrollTo(targetId);
                        }
                        // For links to other pages, the default browser behavior will handle it
                    }
                });
            });

            // Handle direct anchor navigation on page load
            if (window.location.hash) {
                const targetId = window.location.hash.substring(1);
                // Use a small timeout to ensure the page has loaded
                setTimeout(() => {
                    smoothScrollTo(targetId);
                }, 100);
            }
        });
    </script>
    {% endblock %}
</body>
</html>