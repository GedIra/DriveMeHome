<!-- Sidebar -->
{% load static %}
<aside id="sidebar" role="navigation" aria-label="Main sidebar" class="fixed top-16 bottom-0 lg:inset-y-0 left-0 z-40 w-64 bg-primary text-white shadow-lg transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col">
    <div class="flex items-center justify-between gap-3 px-4 py-4 border-b border-white/10">
        <div class="flex items-center gap-3">
            <img src="{% static 'images/svg/white_logo.png' %}" alt="DriveMe Home logo" class="h-10 w-10 rounded-md">
            <div>
            <div class="font-bold text-lg">DriveMe Home</div>
            <div class="text-sm text-white/70">
                {% if user.is_authenticated %}
                    {% if user.is_driver %}
                        Driver Panel
                    {% elif user.is_customer %}
                        Customer Panel
                    {% else %}
                        Admin Panel
                    {% endif %}
                {% else %}
                    Welcome Guest
                {% endif %}
            </div>
            </div>
        </div>
        <!-- Mobile close button -->
        <button id="close-sidebar-button" aria-label="Close sidebar" class="text-white lg:hidden p-2 rounded-md hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/30">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
    </div>

    <nav class="flex-1 overflow-y-auto py-6 px-2 space-y-1">
        {% if user.is_authenticated %}
            <span class="text-white/60 text-xs font-semibold uppercase px-4">Menu</span>
            {% if user.is_driver %}
                <!-- Driver Links -->
                <a href="{% url 'rides:driver_dashboard' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/90 hover:bg-white/5">
                    {% lucide 'layout-dashboard' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Dashboard</span>
                </a>
                <a href="{% url 'rides:ride_history' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'history' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Trip History</span>
                </a>
                <a href="{% url 'users:profile' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'user' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Profile</span>
                </a>
                <a href="{% url 'rides:reviews_list' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'star' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>My Reviews</span>
                </a>
                <a href="{% url 'users:driver_settings' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'settings' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Settings</span>
                </a>
                <div class="px-4 py-2 flex items-center gap-2">
                    {% lucide 'credit-card' size=16 class='text-white/60' stroke_width='2' %}
                    <div>
                        <span class="text-white/40 text-xs font-semibold uppercase">Transactions</span>
                        <div class="text-white/50 text-xs mt-1">Coming soon</div>
                    </div>
                </div>
                <a href="{% url 'users:logout' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'log-out' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Logout</span>
                </a>
            {% elif user.is_customer %}
                <!-- Customer Links -->
                <a href="{% url 'rides:book_ride' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'car' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Book a Ride</span>
                </a>
                <a href="{% url 'rides:ride_history' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'history' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Ride History</span>
                </a>
                <a href="{% url 'users:profile' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'user' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Profile</span>
                </a>
                <a href="{% url 'users:customer_settings' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'settings' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Settings</span>
                </a>
                <div class="px-4 py-2 flex items-center gap-2">
                    {% lucide 'credit-card' size=16 class='text-white/60' stroke_width='2' %}
                    <div>
                        <span class="text-white/40 text-xs font-semibold uppercase">Transactions</span>
                        <div class="text-white/50 text-xs mt-1">Coming soon</div>
                    </div>
                </div>
                <a href="{% url 'users:client_preferences' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'sliders-horizontal' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Preferences</span>
                </a>
                <a href="{% url 'users:logout' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'log-out' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Logout</span>
                </a>
            {% else %}
                 <!-- Generic authenticated user -->
                 <a href="{% url 'users:profile' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'user' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Profile</span>
                </a>
                <a href="{% url 'users:logout' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                    {% lucide 'log-out' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                    <span>Logout</span>
                </a>
            {% endif %}
        {% else %}
            <!-- Public Links -->
            <span class="text-white/60 text-xs font-semibold uppercase px-4">Main</span>
            <a href="{% url 'users:login' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                {% lucide 'log-in' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                <span>Login</span>
            </a>
            <a href="{% url 'users:register' %}" class="group flex items-center gap-3 py-3 px-4 rounded-lg mx-3 text-sm font-medium text-white/80 hover:bg-white/5">
                {% lucide 'user-plus' size=20 class='text-white/80 group-hover:text-white' stroke_width='2' %}
                <span>Register</span>
            </a>
        {% endif %}
    </nav>

    <div class="px-4 py-4 border-t border-white/10 mt-auto">
        {% if user.is_authenticated %}
            <a href="{% url 'users:profile' %}" class="flex items-center gap-3 px-2 hover:opacity-95">
                {% if user.is_customer and user.customer_profile.profile_picture %}
                    <img src="{{ user.customer_profile.profile_picture.url }}" alt="{{ user.get_full_name|default:user.username }}'s avatar" class="w-10 h-10 rounded-full object-cover" loading="lazy">
                {% elif user.is_driver and user.driver_profile.profile_picture %}
                    <img src="{{ user.driver_profile.profile_picture.url }}" alt="{{ user.get_full_name|default:user.username }}'s avatar" class="w-10 h-10 rounded-full object-cover" loading="lazy">
                {% else %}
                    <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-white font-semibold">{{ user.first_name|first|upper|default:user.username|first|upper }}</div>
                {% endif %}
                <div>
                    <div class="text-sm font-semibold">{{ user.get_full_name|default:user.username }}</div>
                    <div class="text-xs text-white/70">{{ user.email }}</div>
                </div>
            </a>
        {% else %}
            <div class="text-sm text-white/70 px-2">Welcome to DriveMe Home</div>
        {% endif %}
    </div>
</aside>
